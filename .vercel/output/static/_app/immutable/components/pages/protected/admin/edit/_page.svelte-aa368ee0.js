import{S as Ce,i as Oe,s as Se,k as f,a as V,q as J,l as m,c as C,m as h,r as q,h as i,n as o,p as ue,b as ne,I as n,K as U,u as ve,B as be,M as Pe,N as Re,w as He,x as je,y as Ue,O as Ge,P as Je,f as me,d as qe,t as ge,z as Me,Q as ze,o as Ke,g as Xe}from"../../../../../chunks/index-0d543ad8.js";import{p as Qe}from"../../../../../chunks/parse-b67c4dc9.js";import{j as Z}from"../../../../../chunks/singletons-e7675bc1.js";import{B as We}from"../../../../../chunks/Breadcrumb-ee341a0b.js";import{m as he}from"../../../../../chunks/marked.esm-75dc6516.js";Z.disable_scroll_handling;Z.goto;Z.invalidate;const Ye=Z.invalidateAll;Z.preload_data;Z.preload_code;Z.before_navigate;Z.after_navigate;const Ze=Z.apply_action;function xe(e){const t=JSON.parse(e);return t.data&&(t.data=Qe(t.data)),t}function $e(e,t=()=>{}){const l=async({action:s,result:r,reset:c})=>{r.type==="success"&&(c!==!1&&HTMLFormElement.prototype.reset.call(e),await Ye()),(location.origin+location.pathname===s.origin+s.pathname||r.type==="redirect"||r.type==="error")&&Ze(r)};async function a(s){var g,I,u;s.preventDefault();const r=new URL((g=s.submitter)!=null&&g.hasAttribute("formaction")?s.submitter.formAction:HTMLFormElement.prototype.cloneNode.call(e).action),c=new FormData(e),d=(I=s.submitter)==null?void 0:I.getAttribute("name");d&&c.append(d,((u=s.submitter)==null?void 0:u.getAttribute("value"))??"");const w=new AbortController;let N=!1;const E=await t({action:r,cancel:()=>N=!0,controller:w,data:c,form:e})??l;if(N)return;let k;try{const v=await fetch(r,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:c,signal:w.signal});k=xe(await v.text()),k.type==="error"&&(k.status=v.status)}catch(v){if((v==null?void 0:v.name)==="AbortError")return;k={type:"error",error:v}}E({action:r,data:c,form:e,update:v=>l({action:r,result:k,reset:v==null?void 0:v.reset}),result:k})}return HTMLFormElement.prototype.addEventListener.call(e,"submit",a),{destroy(){HTMLFormElement.prototype.removeEventListener.call(e,"submit",a)}}}function et(e){let t,l,a,s,r,c,d,w,N,S,E,k,g,I,u,v=he.parse(e[0])+"",M,T,p,y,L,O,F,R,P,x=he.parse(e[1])+"",le,j,$,Q,z,re;return{c(){t=f("link"),l=V(),a=f("article"),s=f("div"),r=J(e[2]),c=V(),d=f("div"),w=f("div"),N=f("h4"),S=J("front."),E=V(),k=f("div"),g=f("textarea"),I=V(),u=f("div"),M=V(),T=f("div"),p=f("h4"),y=J("back."),L=V(),O=f("div"),F=f("textarea"),R=V(),P=f("div"),le=V(),j=f("i"),$=V(),Q=f("div"),this.h()},l(D){t=m(D,"LINK",{rel:!0,href:!0}),l=C(D),a=m(D,"ARTICLE",{class:!0});var A=h(a);s=m(A,"DIV",{class:!0});var se=h(s);r=q(se,e[2]),se.forEach(i),c=C(A),d=m(A,"DIV",{class:!0});var K=h(d);w=m(K,"DIV",{});var W=h(w);N=m(W,"H4",{class:!0});var X=h(N);S=q(X,"front."),X.forEach(i),E=C(W),k=m(W,"DIV",{id:!0});var ee=h(k);g=m(ee,"TEXTAREA",{class:!0,style:!0,id:!0}),h(g).forEach(i),I=C(ee),u=m(ee,"DIV",{class:!0,id:!0});var te=h(u);te.forEach(i),ee.forEach(i),W.forEach(i),M=C(K),T=m(K,"DIV",{});var ae=h(T);p=m(ae,"H4",{class:!0});var fe=h(p);y=q(fe,"back."),fe.forEach(i),L=C(ae),O=m(ae,"DIV",{id:!0});var G=h(O);F=m(G,"TEXTAREA",{class:!0,style:!0,id:!0}),h(F).forEach(i),R=C(G),P=m(G,"DIV",{class:!0,id:!0});var B=h(P);B.forEach(i),G.forEach(i),ae.forEach(i),le=C(K),j=m(K,"I",{style:!0,class:!0}),h(j).forEach(i),K.forEach(i),$=C(A),Q=m(A,"DIV",{style:!0}),h(Q).forEach(i),A.forEach(i),this.h()},h(){o(t,"rel","stylesheet"),o(t,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"),o(s,"class","hidden svelte-1g1t992"),o(N,"class","svelte-1g1t992"),o(g,"class","fc-edit"),ue(g,"display","none"),o(g,"id",e[3]("front_edit")),g.value=e[0],o(u,"class","rendered-markdown svelte-1g1t992"),o(u,"id",e[3]("front_display")),o(k,"id",e[3]("front")),o(p,"class","svelte-1g1t992"),o(F,"class","fc-edit"),ue(F,"display","none"),o(F,"id",e[3]("back_edit")),F.value=e[1],o(P,"class","rendered-markdown svelte-1g1t992"),o(P,"id",e[3]("back_display")),o(O,"id",e[3]("back")),ue(j,"cursor","pointer"),o(j,"class","fa fa-trash"),o(d,"class","fc-container"),ue(Q,"clear","both"),o(a,"class","svelte-1g1t992")},m(D,A){ne(D,t,A),ne(D,l,A),ne(D,a,A),n(a,s),n(s,r),n(a,c),n(a,d),n(d,w),n(w,N),n(N,S),n(w,E),n(w,k),n(k,g),n(k,I),n(k,u),u.innerHTML=v,n(d,M),n(d,T),n(T,p),n(p,y),n(T,L),n(T,O),n(O,F),n(O,R),n(O,P),P.innerHTML=x,n(d,le),n(d,j),n(a,$),n(a,Q),z||(re=[U(u,"keydown",null),U(u,"click",e[5]),U(u,"dblclick",Be),U(P,"keydown",null),U(P,"click",e[5]),U(P,"dblclick",Be),U(j,"keydown",e[4]),U(j,"click",e[4])],z=!0)},p(D,[A]){A&4&&ve(r,D[2]),A&1&&(g.value=D[0]),A&1&&v!==(v=he.parse(D[0])+"")&&(u.innerHTML=v),A&2&&(F.value=D[1]),A&2&&x!==(x=he.parse(D[1])+"")&&(P.innerHTML=x)},i:be,o:be,d(D){D&&i(t),D&&i(l),D&&i(a),z=!1,Pe(re)}}}function Be(e){const t=e.target.parentNode.id.replace("_display",""),l=t+"_edit",a=t+"_display",s=document.getElementById(l),r=document.getElementById(a);s.style.display="block",r.style.display="none"}function tt(e,t,l){let{front:a}=t,{back:s}=t,{uuid:r}=t;const c=function(E){return r+"_"+E},d=Re();function w(){console.log("Updating card with UUID "+r),d("update",{uuid:r,front:a,back:s})}function N(){console.log("Removing card with UUID "+r),d("remove",{uuid:r})}function S(E){const k=E.target.parentNode.id.replace("_display","");let g,I,u,v;k.match("front")?(g=k,I=k.replace("front","back"),u=g+"_edit",v=I+"_edit"):(I=k,g=k.replace("back","front"),u=g+"_edit",v=I+"_edit");const M=document.getElementById(u),T=document.getElementById(v),p=document.getElementById(I+"_display"),y=document.getElementById(g+"_display");M&&M.style.display==="block"&&(l(0,a=M.value),M.style.display="none",y.style.display="block",w()),T&&T.style.display==="block"&&(l(1,s=T.value),T.style.display="none",p.style.display="block",w())}return e.$$set=E=>{"front"in E&&l(0,a=E.front),"back"in E&&l(1,s=E.back),"uuid"in E&&l(2,r=E.uuid)},[a,s,r,c,N,S]}class at extends Ce{constructor(t){super(),Oe(this,t,tt,et,Se,{front:0,back:1,uuid:2})}}function Ne(e,t,l){const a=e.slice();return a[16]=t[l],a}function nt(e){let t,l,a,s,r;return{c(){t=f("div"),l=J("Edit Cards"),a=V(),s=f("div"),r=J("Learning Home")},l(c){t=m(c,"DIV",{});var d=h(t);l=q(d,"Edit Cards"),d.forEach(i),a=C(c),s=m(c,"DIV",{});var w=h(s);r=q(w,"Learning Home"),w.forEach(i)},m(c,d){ne(c,t,d),n(t,l),ne(c,a,d),ne(c,s,d),n(s,r)},p:be,d(c){c&&i(t),c&&i(a),c&&i(s)}}}function Ae(e){let t,l;return t=new at({props:{uuid:e[16].uuid,front:e[16].front,back:e[16].back}}),t.$on("remove",e[6]),t.$on("update",st),{c(){He(t.$$.fragment)},l(a){je(t.$$.fragment,a)},m(a,s){Ue(t,a,s),l=!0},p(a,s){const r={};s&8&&(r.uuid=a[16].uuid),s&8&&(r.front=a[16].front),s&8&&(r.back=a[16].back),t.$set(r)},i(a){l||(me(t.$$.fragment,a),l=!0)},o(a){ge(t.$$.fragment,a),l=!1},d(a){Me(t,a)}}}function lt(e){var Ee;let t,l,a,s,r,c,d,w,N,S,E,k,g,I,u,v,M,T,p,y,L,O,F,R,P,x,le,j,$,Q,z,re,D,A=(((Ee=e[1])==null?void 0:Ee.message)??"insert uploaded images as: ![](/images/____), where _____ is the name of your file.")+"",se,K,W,X,ee,te,ae,fe;t=new We({props:{$$slots:{default:[nt]},$$scope:{ctx:e}}});let G=e[3],B=[];for(let _=0;_<G.length;_+=1)B[_]=Ae(Ne(e,G,_));const Fe=_=>ge(B[_],1,1,()=>{B[_]=null});return{c(){He(t.$$.fragment),l=V(),a=f("main"),s=f("h1"),r=J("Edit cards"),c=V(),d=f("div"),w=f("div"),N=f("h4"),S=J("category. "),E=f("select"),k=V(),g=f("div"),I=f("div"),u=f("form"),v=f("input"),M=V(),T=f("input"),p=V(),y=f("button"),L=J("Upload"),F=V(),R=f("div"),P=f("span"),x=J("Choose files"),le=V(),j=f("span"),$=J(e[0]),Q=V(),z=f("progress"),re=V(),D=f("div"),se=J(A),K=V();for(let _=0;_<B.length;_+=1)B[_].c();W=V(),X=f("button"),ee=J("New Card"),this.h()},l(_){je(t.$$.fragment,_),l=C(_),a=m(_,"MAIN",{class:!0});var b=h(a);s=m(b,"H1",{});var Y=h(s);r=q(Y,"Edit cards"),Y.forEach(i),c=C(b),d=m(b,"DIV",{class:!0});var oe=h(d);w=m(oe,"DIV",{});var H=h(w);N=m(H,"H4",{});var ie=h(N);S=q(ie,"category. "),E=m(ie,"SELECT",{name:!0,id:!0}),h(E).forEach(i),ie.forEach(i),H.forEach(i),k=C(oe),g=m(oe,"DIV",{style:!0});var ce=h(g);I=m(ce,"DIV",{class:!0});var _e=h(I);u=m(_e,"FORM",{method:!0,id:!0,enctype:!0,class:!0});var de=h(u);v=m(de,"INPUT",{id:!0,type:!0,name:!0}),M=C(de),T=m(de,"INPUT",{id:!0,class:!0,accept:!0,type:!0,name:!0}),p=C(de),y=m(de,"BUTTON",{id:!0,class:!0});var ke=h(y);L=q(ke,"Upload"),ke.forEach(i),de.forEach(i),F=C(_e),R=m(_e,"DIV",{class:!0});var pe=h(R);P=m(pe,"SPAN",{class:!0});var Ie=h(P);x=q(Ie,"Choose files"),Ie.forEach(i),le=C(pe),j=m(pe,"SPAN",{class:!0});var we=h(j);$=q(we,e[0]),we.forEach(i),pe.forEach(i),_e.forEach(i),Q=C(ce),z=m(ce,"PROGRESS",{id:!0,style:!0}),h(z).forEach(i),re=C(ce),D=m(ce,"DIV",{id:!0,class:!0});var Te=h(D);se=q(Te,A),Te.forEach(i),ce.forEach(i),oe.forEach(i),K=C(b);for(let ye=0;ye<B.length;ye+=1)B[ye].l(b);W=C(b),X=m(b,"BUTTON",{class:!0});var De=h(X);ee=q(De,"New Card"),De.forEach(i),b.forEach(i),this.h()},h(){o(E,"name","category"),o(E,"id","category"),o(v,"id","upload_file_name"),o(v,"type","hidden"),o(v,"name","upload_file_name"),T.multiple="true",o(T,"id","upload_file"),o(T,"class","file svelte-1o84bcc"),o(T,"accept","image/*"),o(T,"type","file"),o(T,"name","upload_file"),o(y,"id","upload"),o(y,"class","svelte-1o84bcc"),o(u,"method","POST"),o(u,"id","upload-form"),o(u,"enctype","multipart/form-data"),o(u,"class","svelte-1o84bcc"),o(P,"class","fake-btn svelte-1o84bcc"),o(j,"class","file-msg svelte-1o84bcc"),o(R,"class","file-drop-area"),o(I,"class","input-container svelte-1o84bcc"),o(z,"id","upload_progress"),ue(z,"display","none"),o(D,"id","upload_message"),o(D,"class","message svelte-1o84bcc"),ue(g,"margin-top","10px"),o(d,"class","grid"),o(X,"class","add_button"),o(a,"class","container")},m(_,b){Ue(t,_,b),ne(_,l,b),ne(_,a,b),n(a,s),n(s,r),n(a,c),n(a,d),n(d,w),n(w,N),n(N,S),n(N,E),n(d,k),n(d,g),n(g,I),n(I,u),n(u,v),n(u,M),n(u,T),n(u,p),n(u,y),n(y,L),n(I,F),n(I,R),n(R,P),n(P,x),n(R,le),n(R,j),n(j,$),n(g,Q),n(g,z),n(g,re),n(g,D),n(D,se),n(a,K);for(let Y=0;Y<B.length;Y+=1)B[Y].m(a,null);n(a,W),n(a,X),n(X,ee),te=!0,ae||(fe=[U(E,"change",e[4]),U(T,"change",e[11]),U(u,"submit",e[7]),Ge(O=$e.call(null,u,e[12])),U(I,"dragenter",it),U(I,"dragexit",Le),U(I,"drop",Le),U(X,"click",e[5])],ae=!0)},p(_,[b]){var oe;const Y={};if(b&524288&&(Y.$$scope={dirty:b,ctx:_}),t.$set(Y),O&&Je(O.update)&&b&1&&O.update.call(null,_[12]),(!te||b&1)&&ve($,_[0]),(!te||b&2)&&A!==(A=(((oe=_[1])==null?void 0:oe.message)??"insert uploaded images as: ![](/images/____), where _____ is the name of your file.")+"")&&ve(se,A),b&72){G=_[3];let H;for(H=0;H<G.length;H+=1){const ie=Ne(_,G,H);B[H]?(B[H].p(ie,b),me(B[H],1)):(B[H]=Ae(ie),B[H].c(),me(B[H],1),B[H].m(a,W))}for(Xe(),H=G.length;H<B.length;H+=1)Fe(H);qe()}},i(_){if(!te){me(t.$$.fragment,_);for(let b=0;b<G.length;b+=1)me(B[b]);te=!0}},o(_){ge(t.$$.fragment,_),B=B.filter(Boolean);for(let b=0;b<B.length;b+=1)ge(B[b]);te=!1},d(_){Me(t,_),_&&i(l),_&&i(a),ze(B,_),ae=!1,Pe(fe)}}}async function st(e){const t=document.getElementById("category").value,l="/api/card/"+e.detail.uuid;await(await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({front:e.detail.front,back:e.detail.back,category:t})})).json()}function ot(){const e=document.getElementById("upload_progress"),t=document.getElementById("upload_message");t.style.display="none",e.style.display="block"}function rt(){const e=document.getElementById("upload_progress"),t=document.getElementById("upload_message");t.style.display="block",e.style.display="none"}function it(e){e.target.parentElement.parentElement.style.backgroundColor="#f3f3f3"}function Le(e){e.target.parentElement.parentElement.style.backgroundColor="white"}function Ve(e){return e.replace(/(.*)(\.\w{2,4})/,"$2")}function ct(e,t,l){let a,s,r=[],{message:c="or drag and drop files here."}=t,{allowed:d=[".png",".jpg",".jpeg",".tif",".tiff",".csv",".JPG",".JPEG",".PNG",".TIF",".TIFF",".CSV"]}=t,{form:w}=t,{data:N}=t,S=[];async function E(){const y="/api/category/"+document.getElementById("category").value,L=await fetch(y,{method:"GET",headers:{"Content-Type":"application/json"}});l(10,S=await L.json())}async function k(p){const y=document.getElementById("category").value,L="/api/card";let O={front:"",back:"",category:y};O=await(await fetch(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json(),l(10,S=[...S,O])}async function g(p){document.getElementById("category").value;const y="/api/card/"+p.detail.uuid;await fetch(y,{method:"DELETE"}),l(10,S=S.filter(L=>L.uuid!=p.detail.uuid))}function I(){l(0,c="UPLOADING...")}function u(p){return p.filter(y=>d.indexOf(Ve(y))>-1)}function v(p){return p.filter(y=>!(d.indexOf(Ve(y))>-1))}Ke(()=>{var p=document.getElementById("category");N.categories.forEach((y,L)=>p.options[L]=new Option(y,y)),p.value=N.categories[0],E(N.categories[0]),document.getElementById("upload_file").onchange=function(){r=[];for(const O of s)r.push(O.name);const y=v(r),L=u(r);L.length>1?l(0,c=L.length+" files selected."):l(0,c=L.length?L[0]:""),y.length>0&&l(0,c=c+"("+y.length+" files ignored--only .png, .jpg, .csv, and .tif are supported.)"),document.getElementById("upload_file_name").value=r}});function M(){s=this.files,l(2,s)}const T=({form:p,data:y,cancel:L})=>(ot(),async({result:O})=>{rt(),l(0,c="Done")});return e.$$set=p=>{"message"in p&&l(0,c=p.message),"allowed"in p&&l(8,d=p.allowed),"form"in p&&l(1,w=p.form),"data"in p&&l(9,N=p.data)},e.$$.update=()=>{e.$$.dirty&1024&&l(3,a=S)},[c,w,s,a,E,k,g,I,d,N,S,M,T]}class pt extends Ce{constructor(t){super(),Oe(this,t,ct,lt,Se,{message:0,allowed:8,form:1,data:9})}}export{pt as default};
